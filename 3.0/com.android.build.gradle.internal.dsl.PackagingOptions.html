<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>PackagingOptions - Android Plugin 3.0.0-dev DSL Reference</title><link type="text/css" rel="stylesheet" href="base.css"><link type="text/css" rel="stylesheet" href="docs.css"><link type="text/css" rel="stylesheet" href="dsl.css"><meta content="DocBook XSL Stylesheets V1.75.2" name="generator"><link rel="home" href="index.html" title="Android Plugin 3.0.0-dev DSL Reference"><link rel="up" href="index.html" title="Android Plugin 3.0.0-dev DSL Reference"><link rel="prev" href="com.android.build.gradle.internal.dsl.LintOptions.html" title="LintOptions - Android Plugin 3.0.0-dev DSL Reference"><link rel="next" href="com.android.build.gradle.internal.dsl.ProductFlavor.html" title="ProductFlavor - Android Plugin 3.0.0-dev DSL Reference"></head><body><div class="sidebar"><ul><li><a xmlns:xslthl="http://xslthl.sf.net" href="index.html" title="Android Plugin 3.0.0-dev DSL Reference">Home</a></li><li class="sidebarHeading selected">PackagingOptions</li><ul class="sections"><li><a xmlns:xslthl="http://xslthl.sf.net" href="com.android.build.gradle.internal.dsl.PackagingOptions.html#N130D3" title="Properties">Properties</a></li><li><a xmlns:xslthl="http://xslthl.sf.net" href="com.android.build.gradle.internal.dsl.PackagingOptions.html#N13103" title="Methods">Methods</a></li></ul><li class="sidebarHeading">Extension types</li><li><a class="link" href="com.android.build.gradle.AppExtension.html"><code class="literal">AppExtension</code></a></li><li><a class="link" href="com.android.build.gradle.LibraryExtension.html"><code class="literal">LibraryExtension</code></a></li><li><a class="link" href="com.android.build.gradle.TestExtension.html"><code class="literal">TestExtension</code></a></li><li><a class="link" href="com.android.build.gradle.FeatureExtension.html"><code class="literal">FeatureExtension</code></a></li><li class="sidebarHeading">Configuration blocks</li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:aaptOptions(org.gradle.api.Action)"><code class="literal">aaptOptions { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:adbOptions(org.gradle.api.Action)"><code class="literal">adbOptions { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:buildTypes(org.gradle.api.Action)"><code class="literal">buildTypes { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:compileOptions(org.gradle.api.Action)"><code class="literal">compileOptions { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:dataBinding(org.gradle.api.Action)"><code class="literal">dataBinding { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:defaultConfig(org.gradle.api.Action)"><code class="literal">defaultConfig { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:dexOptions(org.gradle.api.Action)"><code class="literal">dexOptions { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:externalNativeBuild(org.gradle.api.Action)"><code class="literal">externalNativeBuild { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:jacoco(org.gradle.api.Action)"><code class="literal">jacoco { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:lintOptions(org.gradle.api.Action)"><code class="literal">lintOptions { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:packagingOptions(org.gradle.api.Action)"><code class="literal">packagingOptions { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:productFlavors(org.gradle.api.Action)"><code class="literal">productFlavors { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:signingConfigs(org.gradle.api.Action)"><code class="literal">signingConfigs { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:sourceSets(org.gradle.api.Action)"><code class="literal">sourceSets { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:splits(org.gradle.api.Action)"><code class="literal">splits { }</code></a></li><li><a class="link" href="com.android.build.gradle.BaseExtension.html#com.android.build.gradle.BaseExtension:testOptions(org.gradle.api.Action)"><code class="literal">testOptions { }</code></a></li></ul></div><div class="content"><div class="chapter"><div class="titlepage"><div><div><h1 xmlns:xslthl="http://xslthl.sf.net"><a name="com.android.build.gradle.internal.dsl.PackagingOptions"></a>PackagingOptions</h1></div></div></div><p>DSL object for configuring APK packaging options.

</p><p>Packaging options are configured with three sets of paths: first-picks, merges and excludes:

</p><div class="variablelist"><dl><dt><span class="term">First-pick
  </span></dt><dd>Paths that match a first-pick pattern will be selected into the APK. If more than one path
      matches the first-pick, only the first found will be selected.
  </dd><dt><span class="term">Merge
  </span></dt><dd>Paths that match a merge pattern will be concatenated and merged into the APK. When merging
      two files, a newline will be appended to the end of the first file, if it doesn't end with
      a newline already. This is done for all files, regardless of the type of contents.
  </dd><dt><span class="term">Exclude
  </span></dt><dd>Paths that match an exclude pattern will not be included in the APK.
</dd></dl></div><p>

To decide the action on a specific path, the following algorithm is used:

</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">If any of the first-pick patterns match the path and that path has not been included in the
      FULL_APK, add it to the FULL_APK.
  </li><li class="listitem">If any of the first-pick patterns match the path and that path has already been included in
      the FULL_APK, do not include the path in the FULL_APK.
  </li><li class="listitem">If any of the merge patterns match the path and that path has not been included in the APK,
      add it to the APK.
  </li><li class="listitem">If any of the merge patterns match the path and that path has already been included in the
      FULL_APK, concatenate the contents of the file to the ones already in the FULL_APK.
  </li><li class="listitem">If any of the exclude patterns match the path, do not include it in the APK.
  </li><li class="listitem">If none of the patterns above match the path and the path has not been included in the APK,
      add it to the APK.
  </li><li class="listitem">Id none of the patterns above match the path and the path has been included in the APK,
      fail the build and signal a duplicate path error.
</li></ol></div><p>Patterns in packaging options are specified as globs following the syntax in the <a class="ulink" href="https://docs.oracle.com/javase/8/docs/api/java/nio/file/FileSystem.html#getPathMatcher-java.lang.String-" target="_top">
Java Filesystem API</a>. All paths should be configured using forward slashes (<code class="literal">/</code>).

</p><p>All paths to be matched are provided as absolute paths from the root of the apk archive. So,
for example, <code class="literal">classes.dex</code> is matched as <code class="literal">/classes.dex</code>. This allows defining
patterns such as <code class="literal">**/foo</code> to match the file <code class="literal">foo</code> in any directory,
including the root. Any pattern that does not start with a forward slash (or wildcard) is
automatically prepended with a forward slash. So, <code class="literal">file</code> and <code class="literal">/file</code> are effectively
the same pattern.

</p><p>The default values are:

</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Pick first: none
  </li><li class="listitem">Merge: <code class="literal">/META-INF/services/**</code></li><li class="listitem">Exclude:
      <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><code class="literal">/META-INF/LICENSE</code></li><li class="listitem"><code class="literal">/META-INF/LICENSE.txt</code></li><li class="listitem"><code class="literal">/META-INF/NOTICE</code></li><li class="listitem"><code class="literal">/META-INF/NOTICE.txt</code></li><li class="listitem"><code class="literal">/LICENSE</code></li><li class="listitem"><code class="literal">/LICENSE.txt</code></li><li class="listitem"><code class="literal">/NOTICE</code></li><li class="listitem"><code class="literal">/NOTICE.txt</code></li><li class="listitem"><code class="literal">/META-INF/*.DSA</code> (all DSA signature files)
        </li><li class="listitem"><code class="literal">/META-INF/*.EC</code> (all EC signature files)
        </li><li class="listitem"><code class="literal">/META-INF/*.SF</code> (all signature files)
        </li><li class="listitem"><code class="literal">/META-INF/*.RSA</code> (all RSA signature files)
        </li><li class="listitem"><code class="literal">/META-INF/maven/**</code> (all files in the <code class="literal">maven</code> meta inf
            directory)
        </li><li class="listitem"><code class="literal">**/.svn/**</code> (all <code class="literal">.svn</code> directory contents)
        </li><li class="listitem"><code class="literal">**/CVS/**</code> (all <code class="literal">CVS</code> directory contents)
        </li><li class="listitem"><code class="literal">**/SCCS/**</code> (all <code class="literal">SCCS</code> directory contents)
        </li><li class="listitem"><code class="literal">**/.*</code> (all UNIX hidden files)
        </li><li class="listitem"><code class="literal">**/.*/**</code> (all contents of UNIX hidden
            directories)
        </li><li class="listitem"><code class="literal">**/*~</code> (temporary files)
        </li><li class="listitem"><code class="literal">**/thumbs.db</code></li><li class="listitem"><code class="literal">**/picasa.ini</code></li><li class="listitem"><code class="literal">**/about.html</code></li><li class="listitem"><code class="literal">**/package.html</code></li><li class="listitem"><code class="literal">**/overview.html</code></li><li class="listitem"><code class="literal">**/_*</code></li><li class="listitem"><code class="literal">**/_*/**</code></li></ul></div></li></ul></div><p>Example that adds the first <code class="literal">anyFileWillDo</code> file found and ignores all the others and
that excludes anything inside a <code class="literal">secret-data</code> directory that exists in the root:

</p><pre class="programlisting">packagingOptions {
    pickFirst <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"anyFileWillDo"</span>
    exclude <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"/secret-data/**"</span>
}</pre><p>Example that removes all patterns:

</p><pre class="programlisting">packagingOptions {
    pickFirsts = [] <span xmlns:xslthl="http://xslthl.sf.net" class="hl-comment">// Not really needed because the default is empty.</span>
    merges = []     <span xmlns:xslthl="http://xslthl.sf.net" class="hl-comment">// Not really needed because the default is empty.</span>
    excludes = []
}</pre><p>Example that merges all <code class="literal">LICENSE.txt</code> files in the root.

</p><pre class="programlisting">packagingOptions {
    merge <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"/LICENSE.txt"</span> <span xmlns:xslthl="http://xslthl.sf.net" class="hl-comment">// Same as: merges += ["/LICENSE.txt"]</span>
    excludes -= [<span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"/LICENSE.txt"</span>] <span xmlns:xslthl="http://xslthl.sf.net" class="hl-comment">// Not really needed because merges take precedence over excludes.</span>
}</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="N130D3"></a>Properties</h3></div></div></div><div xmlns:xslthl="http://xslthl.sf.net" class="table"><div class="table-contents"><table id="N130D6"><thead><tr><td>Property</td><td>Description</td></tr></thead><tr><td><a class="link" href="com.android.build.gradle.internal.dsl.PackagingOptions.html#com.android.build.gradle.internal.dsl.PackagingOptions:doNotStrip"><code class="literal">doNotStrip</code></a></td><td><p>The list of patterns for native library that should not be stripped of debug symbols.

</p></td></tr><tr><td><a class="link" href="com.android.build.gradle.internal.dsl.PackagingOptions.html#com.android.build.gradle.internal.dsl.PackagingOptions:excludes"><code class="literal">excludes</code></a></td><td><p>The list of excluded paths.</p></td></tr><tr><td><a class="link" href="com.android.build.gradle.internal.dsl.PackagingOptions.html#com.android.build.gradle.internal.dsl.PackagingOptions:merges"><code class="literal">merges</code></a></td><td><p>The list of patterns where all occurrences are concatenated and packaged in the APK.</p></td></tr><tr><td><a class="link" href="com.android.build.gradle.internal.dsl.PackagingOptions.html#com.android.build.gradle.internal.dsl.PackagingOptions:pickFirsts"><code class="literal">pickFirsts</code></a></td><td><p>The list of patterns where the first occurrence is packaged in the APK. First pick
patterns do get packaged in the APK, but only the first occurrence found gets packaged.</p></td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="N13103"></a>Methods</h3></div></div></div><div xmlns:xslthl="http://xslthl.sf.net" class="table"><div class="table-contents"><table id="N13106"><thead><tr><td>Method</td><td>Description</td></tr></thead><tr><td><code class="literal"><a class="link" href="com.android.build.gradle.internal.dsl.PackagingOptions.html#com.android.build.gradle.internal.dsl.PackagingOptions:exclude(java.lang.String)">exclude</a>(pattern)</code></td><td><p>Adds an excluded pattern.</p></td></tr><tr><td><code class="literal"><a class="link" href="com.android.build.gradle.internal.dsl.PackagingOptions.html#com.android.build.gradle.internal.dsl.PackagingOptions:merge(java.lang.String)">merge</a>(pattern)</code></td><td><p>Adds a merge pattern.</p></td></tr><tr><td><code class="literal"><a class="link" href="com.android.build.gradle.internal.dsl.PackagingOptions.html#com.android.build.gradle.internal.dsl.PackagingOptions:pickFirst(java.lang.String)">pickFirst</a>(pattern)</code></td><td><p>Adds a first-pick pattern.</p></td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="N1312D"></a>Script blocks</h3></div></div></div><p>No script blocks</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="N13132"></a>Property details</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="signature"><a name="com.android.build.gradle.internal.dsl.PackagingOptions:doNotStrip"></a><code class="classname"><a class="ulink" href="http://download.oracle.com/javase/7/docs/api/java/util/Set.html" target="_top"><code class="classname">Set</code></a>&lt;<a class="ulink" href="http://download.oracle.com/javase/7/docs/api/java/lang/String.html" target="_top"><code class="classname">String</code></a>&gt;</code> <code class="literal">doNotStrip</code></h4></div></div></div><p>The list of patterns for native library that should not be stripped of debug symbols.

</p><p>Example: <code class="literal">packagingOptions.doNotStrip "*/armeabi-v7a/libhello-jni.so"</code></p></div><div class="section"><div class="titlepage"><div><div><h4 class="signature"><a name="com.android.build.gradle.internal.dsl.PackagingOptions:excludes"></a><code class="classname"><a class="ulink" href="http://download.oracle.com/javase/7/docs/api/java/util/Set.html" target="_top"><code class="classname">Set</code></a>&lt;<a class="ulink" href="http://download.oracle.com/javase/7/docs/api/java/lang/String.html" target="_top"><code class="classname">String</code></a>&gt;</code> <code class="literal">excludes</code></h4></div></div></div><p>The list of excluded paths.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="signature"><a name="com.android.build.gradle.internal.dsl.PackagingOptions:merges"></a><code class="classname"><a class="ulink" href="http://download.oracle.com/javase/7/docs/api/java/util/Set.html" target="_top"><code class="classname">Set</code></a>&lt;<a class="ulink" href="http://download.oracle.com/javase/7/docs/api/java/lang/String.html" target="_top"><code class="classname">String</code></a>&gt;</code> <code class="literal">merges</code></h4></div></div></div><p>The list of patterns where all occurrences are concatenated and packaged in the APK.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="signature"><a name="com.android.build.gradle.internal.dsl.PackagingOptions:pickFirsts"></a><code class="classname"><a class="ulink" href="http://download.oracle.com/javase/7/docs/api/java/util/Set.html" target="_top"><code class="classname">Set</code></a>&lt;<a class="ulink" href="http://download.oracle.com/javase/7/docs/api/java/lang/String.html" target="_top"><code class="classname">String</code></a>&gt;</code> <code class="literal">pickFirsts</code></h4></div></div></div><p>The list of patterns where the first occurrence is packaged in the APK. First pick
patterns do get packaged in the APK, but only the first occurrence found gets packaged.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="N13189"></a>Method details</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="signature"><a name="com.android.build.gradle.internal.dsl.PackagingOptions:exclude(java.lang.String)"></a><code class="classname">void</code> <code class="literal">exclude</code>(<a class="ulink" href="http://download.oracle.com/javase/7/docs/api/java/lang/String.html" target="_top"><code class="classname">String</code></a> pattern)</h4></div></div></div><p>Adds an excluded pattern.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="signature"><a name="com.android.build.gradle.internal.dsl.PackagingOptions:merge(java.lang.String)"></a><code class="classname">void</code> <code class="literal">merge</code>(<a class="ulink" href="http://download.oracle.com/javase/7/docs/api/java/lang/String.html" target="_top"><code class="classname">String</code></a> pattern)</h4></div></div></div><p>Adds a merge pattern.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="signature"><a name="com.android.build.gradle.internal.dsl.PackagingOptions:pickFirst(java.lang.String)"></a><code class="classname">void</code> <code class="literal">pickFirst</code>(<a class="ulink" href="http://download.oracle.com/javase/7/docs/api/java/lang/String.html" target="_top"><code class="classname">String</code></a> pattern)</h4></div></div></div><p>Adds a first-pick pattern.</p></div></div></div><div id="copyright">
                       Except as noted, this content is licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a>.
                       For details and restrictions, see the <a href="http://developer.android.com/license.html">Content License</a>.
                   </div></div></body></html>